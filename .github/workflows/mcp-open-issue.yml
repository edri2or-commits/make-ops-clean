
name: MCP Open Issue
on:
  workflow_dispatch:
    inputs:
      title:
        description: Issue title
        required: true
      body:
        description: Issue body (optional)
        required: false
        default: ""
permissions:
  issues: write
  contents: read
jobs:
  open:
    runs-on: ubuntu-latest
    steps:
      - name: Open issue via GitHub API
        id: create
        uses: actions/github-script@v7
        with:
          script: |
            const {owner, repo} = context.repo;
            const title = core.getInput('title');
            const body = core.getInput('body') || '';
            const issue = await github.rest.issues.create({owner, repo, title, body});
            core.setOutput('issue_url', issue.data.html_url);
            core.notice(`issue_url=${issue.data.html_url}`);
      - name: Write proof.json
        run: |
          jq -n --arg issue_url "${{ steps.create.outputs.issue_url }}" --arg run_url "${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}" '{issue_url:$issue_url, run_url:$run_url}' > proof.json
      - name: Upload proof
        uses: actions/upload-artifact@v4
        with:
          name: proof
          path: proof.json
