name: init-b bridge
on:
  push:
    branches: [ "main" ]
    paths: [ ".github/workflows/init-b-bridge.yml" ]
  workflow_dispatch:

permissions:
  contents: read

jobs:
  proof:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Generate webhook_info.json
        run: |
          mkdir -p initb_bridge_proof
          printf '%s\n' '{' \
            "  \"bridge\": \"init-b\"," \
            "  \"scenario_id\": \"${SCENARIO_ID:-unknown}\"," \
            "  \"timestamp\": \"$(date -u +%FT%TZ)\"," \
            "  \"runner\": \"${GITHUB_ACTOR}\"," \
            "  \"run_id\": \"${GITHUB_RUN_ID}\"," \
            "  \"repo\": \"${GITHUB_REPOSITORY}\"" \
            '}' > initb_bridge_proof/webhook_info.json
          head -n 5 initb_bridge_proof/webhook_info.json
      - name: Upload artifact
        uses: actions/upload-artifact@v4
        with:
          name: initb_bridge_proof
          path: initb_bridge_proof
          if-no-files-found: error
