name: MCP Open PR from Branch
on:
  workflow_dispatch:
    inputs:
      base: { description: Base, required: true, default: main }
      head: { description: Head, required: true }
      title: { description: Title, required: true }
      body: { description: Body, required: false, default: "" }
permissions:
  pull-requests: write
  contents: read
jobs:
  open:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/github-script@v7
        id: pr
        with:
          script: |
            const {owner, repo} = context.repo;
            const base = core.getInput('base');
            const head = core.getInput('head');
            const title = core.getInput('title');
            const body = core.getInput('body') || '';
            const pr = await github.rest.pulls.create({owner, repo, base, head, title, body});
            core.setOutput('url', pr.data.html_url);
            core.notice(`pr_url=${pr.data.html_url}`);
      - run: echo "{"pr_url":"${{ steps.pr.outputs.url }}","run_url":"${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}"}" > proof.json
      - uses: actions/upload-artifact@v4
        with: { name: proof, path: proof.json }
